# git-source-control
 Server-side source control extension for Git on InterSystems' platforms

 <br/>

## Prerequisites

IRIS instance with license key

 <br/>

## Installation and Setup
---

1. Clone this repository
2. Install an instance of IRIS.
3. Install ZPM, following the directions here: https://openexchange.intersystems.com/package/ObjectScript-Package-Manager
4. Load this repository into IRIS using ZPM. 
    ```
    zpm "load <absolute path to git-source-control> -verbose"
    ```
5. To port your Git settings to IRIS, set the following globals:
   ```
   set ^|"%SYS"|SYS("SourceControl","Git","%defaultTemp")="c:\temp\"
   set ^|"%SYS"|SYS("SourceControl","Git","%gitBinExists")=1
   set ^|"%SYS"|SYS("SourceControl","Git","%gitBinPath")="C:\Program Files\Git\bin\git.exe"
   ```
 
6. Run this to set the extension interface up in your editor. 
   ```
   do ##class(%Studio.SourceControl.Interface).SourceControlClassSet("SourceControl.Git.Extension")
   ```
7.  Set the following globals:
    ```
    set ^SYS("SourceControl","Git","settings","groupByFolder")=""
    set ^SYS("SourceControl","Git","settings","mappings","CLS","*")="cls/"
    set ^SYS("SourceControl","Git","settings","mappings","CLS","UnitTest")="test/"
    ```
8.  Set up `isfs` server-side editing in VS Code. First save your current workspace in which you have the code open. Then, open the `.code-workspace` file generated by VS Code and add the following to the list of folders: 
    ```
    {
        "name": "<whatever you want the folder to show up as in the project explorer view>",
        "uri": "isfs://<instance_name>:<namespace_name>/"
    }
    ```
9.  Go to the URL [http://localhost:<port_number>/isc/studio/usertemplates/gitsourcecontrol/webuidriver.csp/USER]([http://localhost:<port_number>/isc/studio/usertemplates/gitsourcecontrol/webuidriver.csp/USER) and verify that you can see the commit history of your current project. 
10. Verify that the server side source control on your editor shows all the Git options by selecting a file on the server and clicking the Server-side Source Control button on the top right-hand corner. Launch the Git UI and verify it runs as expected.  

<br/>

## During Development

:warning: Whenever any code in this project is updated outside of the server (e.g. after every `git pull`), you _have_ to run `zpm "load <absolute path to git-source-control> -verbose"`. Otherwise the changes won't be reflected on the server.
