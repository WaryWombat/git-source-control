# git-source-control
 Server-side source control extension for Git on InterSystems' platforms

 <br/>

## Installation and Setup
---

1. Clone this repository
2. Install an instance of IRIS **version 2020.1.0**.
3. Install ZPM, following the directions here: https://openexchange.intersystems.com/package/ObjectScript-Package-Manager
4. Load this repository into IRIS using ZPM. 
    ```
    zpm "load <absolute path to git-source-control> -verbose"
    ```
5. Verify the filecopies in module.xml have happened. 
6. Enter your Git settings in gitprojectsettings.csp. For this, go to [http://localhost:<port_number>/isc/studio/usertemplates/gitsourcecontrol/gitprojectsettings.csp?NSpace=USER](http://localhost:<port_number>/isc/studio/usertemplates/gitsourcecontrol/gitprojectsettings.csp?NSpace=USER). Change the port number in the URL to correspond to your local IRIS instance. 
7. Run this to setup the extension interface in your editor. 
   ```
   do ##class(%Studio.SourceControl.Interface).SourceControlClassSet("SourceControl.Git.Extension")
   ```
8.  Setup the following globals:
    ```
    set ^SYS("SourceControl","Git","settings","groupByFolder")=""
    set ^SYS("SourceControl","Git","settings","mappings","CLS","*")="cls/"
    set ^SYS("SourceControl","Git","settings","mappings","CLS","UnitTest")="test/"
    ```
9. Set up `isfs` server-side editing in VS Code. First save your current workspace in which you have the code open. Then, open the `.code-workspace` file generated by VS Code and add the following to the list of folders: 
    ```
    {
        "name": "<instance_name>:<namespace_name>",
        "uri": "isfs://<instance_name>:<namespace_name>/"
    }
    ```
    The name can be any string. 
10. Go to the URL [http://localhost:<port_number>/isc/studio/usertemplates/gitsourcecontrol/webuidriver.csp/USER]([http://localhost:<port_number>/isc/studio/usertemplates/gitsourcecontrol/webuidriver.csp/USER) and verify that you can see the commit history of your current project. 
11. Verify that the server side source control on your editor shows all the Git options by selecting a file on the server and clicking the Server-side Source Control button on the top right-hand corner. Launch the Git UI and verify it runs as expected.  

<br/>
<br/>

## During Development

> :warning: Whenever any code in the `SourceControl` package is updated outside of the server (e.g. after every `git pull`), you _have_ to run `zpm "load <absolute path to git-source-control> -verbose"`. Otherwise the changes won't be reflected on the server.
